<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
         http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd">

    <changeSet id="create-users-table" author="matthew">
        <createTable tableName="users">
            <column name="id" type="INT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="username" type="VARCHAR(255)">
                <constraints unique="true" nullable="false"/>
            </column>
            <column name="password" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="role" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>

    <changeSet id="create-form-table" author="matthew">
        <createTable tableName="form">
            <column name="id" type="INT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="creator_id" type="INT">
                <constraints nullable="false" foreignKeyName="fk_form_creator" references="users(id)"/>
            </column>
            <column name="title" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="description" type="TEXT"/>
        </createTable>
    </changeSet>

    <changeSet id="create-questions-table" author="matthew">
        <createTable tableName="questions">
            <column name="id" type="INT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="form_id" type="INT">
                <constraints nullable="false" foreignKeyName="fk_question_form" references="form(id)"/>
            </column>
            <column name="text" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="type" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="image_url" type="VARCHAR(255)"/>
        </createTable>
    </changeSet>

    <changeSet id="create-options-table" author="matthew">
        <createTable tableName="options">
            <column name="id" type="INT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="question_id" type="INT">
                <constraints nullable="false" foreignKeyName="fk_option_question" references="questions(id)"/>
            </column>
            <column name="text" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>

    <changeSet id="create-responses-table" author="matthew">
        <createTable tableName="responses">
            <column name="id" type="INT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="user_id" type="INT">
                <constraints nullable="false" foreignKeyName="fk_response_user" references="users(id)"/>
            </column>
            <column name="form_id" type="INT">
                <constraints nullable="false" foreignKeyName="fk_response_form" references="form(id)"/>
            </column>
        </createTable>
    </changeSet>

    <changeSet id="create-answers-table" author="matthew">
        <createTable tableName="answers">
            <column name="id" type="INT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="response_id" type="INT">
                <constraints nullable="false" foreignKeyName="fk_answer_response" references="responses(id)"/>
            </column>
            <column name="question_id" type="INT">
                <constraints nullable="false" foreignKeyName="fk_answer_question" references="questions(id)"/>
            </column>
            <column name="answer_text" type="TEXT"/>
            <column name="selected_option_id" type="INT">
                <constraints foreignKeyName="fk_answer_option" references="options(id)"/>
            </column>
        </createTable>
    </changeSet>

    <changeSet id="insert-users" author="matthew">
        <insert tableName="users">
            <column name="username" value="creator1"/>
            <column name="password" value="password1"/>
            <column name="role" value="CREATOR"/>
        </insert>
        <insert tableName="users">
            <column name="username" value="user1"/>
            <column name="password" value="password2"/>
            <column name="role" value="USER"/>
        </insert>
    </changeSet>

    <changeSet id="insert-user" author="alexey">
        <insert tableName="users">
            <column name="username" value="glad_valakas"/>
            <column name="password" value="password3"/>
            <column name="role" value="USER"/>
        </insert>
        <insert tableName="users">
            <column name="username" value="user3"/>
            <column name="password" value="password4"/>
            <column name="role" value="USER"/>
        </insert>
    </changeSet>

    <changeSet id="insert-form" author="matthew">
        <insert tableName="form">
            <column name="creator_id" valueComputed="(SELECT id FROM users WHERE username = 'creator1')"/>
            <column name="title" value="Первая форма"/>
            <column name="description" value="Это наша первая форма"/>
        </insert>
    </changeSet>

    <changeSet id="insert-questions" author="matthew">
        <insert tableName="questions">
            <column name="form_id" valueComputed="(SELECT id FROM form WHERE title = 'Первая форма')"/>
            <column name="text" value="Какой твой возраст?"/>
            <column name="type" value="NUMERIC"/>
        </insert>
        <insert tableName="questions">
            <column name="form_id" valueComputed="(SELECT id FROM form WHERE title = 'Первая форма')"/>
            <column name="text" value="Твой любимый цвет?"/>
            <column name="type" value="SINGLE_CHOICE"/>
        </insert>
        <insert tableName="questions">
            <column name="form_id" valueComputed="(SELECT id FROM form WHERE title = 'Первая форма')"/>
            <column name="text" value="Выбери свои хобби:"/>
            <column name="type" value="MULTIPLE_CHOICE"/>
        </insert>
        <insert tableName="questions">
            <column name="form_id" valueComputed="(SELECT id FROM form WHERE title = 'Первая форма')"/>
            <column name="text" value="Напиши о себе."/>
            <column name="type" value="TEXT"/>
        </insert>
    </changeSet>

    <changeSet id="insert-options" author="matthew">
        <insert tableName="options">
            <column name="question_id" valueComputed="(SELECT id FROM questions WHERE text = 'Твой любимый цвет?')"/>
            <column name="text" value="Красный"/>
        </insert>
        <insert tableName="options">
            <column name="question_id" valueComputed="(SELECT id FROM questions WHERE text = 'Твой любимый цвет?')"/>
            <column name="text" value="Голубой"/>
        </insert>
        <insert tableName="options">
            <column name="question_id" valueComputed="(SELECT id FROM questions WHERE text = 'Твой любимый цвет?')"/>
            <column name="text" value="Зеленый"/>
        </insert>
    </changeSet>

    <changeSet id="insert-options-multiple-choice" author="matthew">
        <insert tableName="options">
            <column name="question_id" valueComputed="(SELECT id FROM questions WHERE text = 'Выбери свои хобби:')"/>
            <column name="text" value="Чтение"/>
        </insert>
        <insert tableName="options">
            <column name="question_id" valueComputed="(SELECT id FROM questions WHERE text = 'Выбери свои хобби:')"/>
            <column name="text" value="Спорт"/>
        </insert>
        <insert tableName="options">
            <column name="question_id" valueComputed="(SELECT id FROM questions WHERE text = 'Выбери свои хобби:')"/>
            <column name="text" value="Путешествия"/>
        </insert>
    </changeSet>

    <changeSet id="insert-questions-2" author="alexey">
        <insert tableName="questions">
            <column name="form_id" valueComputed="(SELECT id FROM form WHERE title = 'Первая форма')"/>
            <column name="text" value="Твоё любимое число"/>
            <column name="type" value="NUMERIC"/>
        </insert>
        <insert tableName="questions">
            <column name="form_id" valueComputed="(SELECT id FROM form WHERE title = 'Первая форма')"/>
            <column name="text" value="Выбери любимую команду"/>
            <column name="type" value="SINGLE_CHOICE"/>
        </insert>
        <insert tableName="questions">
            <column name="form_id" valueComputed="(SELECT id FROM form WHERE title = 'Первая форма')"/>
            <column name="text" value="Выбери любимые предметы"/>
            <column name="type" value="MULTIPLE_CHOICE"/>
        </insert>
        <insert tableName="questions">
            <column name="form_id" valueComputed="(SELECT id FROM form WHERE title = 'Первая форма')"/>
            <column name="text" value="Напиши что ты думаешь об этом опросе"/>
            <column name="type" value="TEXT"/>
        </insert>
    </changeSet>

    <changeSet id="insert-options-2" author="matthew">
        <insert tableName="options">
            <column name="question_id" valueComputed="(SELECT id FROM questions WHERE text = 'Выбери любимую команду')"/>
            <column name="text" value="Зенит"/>
        </insert>
        <insert tableName="options">
            <column name="question_id" valueComputed="(SELECT id FROM questions WHERE text = 'Выбери любимую команду')"/>
            <column name="text" value="Краснодар"/>
        </insert>
        <insert tableName="options">
            <column name="question_id" valueComputed="(SELECT id FROM questions WHERE text = 'Выбери любимую команду')"/>
            <column name="text" value="Динамо Москва"/>
        </insert>
    </changeSet>

    <changeSet id="insert-options-multiple-choice-2" author="matthew">
        <insert tableName="options">
            <column name="question_id" valueComputed="(SELECT id FROM questions WHERE text = 'Выбери любимые предметы')"/>
            <column name="text" value="Математика"/>
        </insert>
        <insert tableName="options">
            <column name="question_id" valueComputed="(SELECT id FROM questions WHERE text = 'Выбери любимые предметы')"/>
            <column name="text" value="Физика"/>
        </insert>
        <insert tableName="options">
            <column name="question_id" valueComputed="(SELECT id FROM questions WHERE text = 'Выбери любимые предметы')"/>
            <column name="text" value="Литература"/>
        </insert>
    </changeSet>

    <changeSet id="insert-response-1" author="alexey">
        <insert tableName="responses">
            <column name="user_id" value="2"/>
            <column name="form_id" value="1"/>
        </insert>
    </changeSet>
    
    <changeSet id="insert-answers-resp1" author="alexey">
        <insert tableName="answers">
            <column name="response_id" value="1"/>
            <column name="question_id" value="1"/>
            <column name="answer_text" value="35"/>
        </insert>
        <insert tableName="answers">
            <column name="response_id" value="1"/>
            <column name="question_id" value="2"/>
            <column name="selected_option_id" value="2"/>
        </insert>
        <insert tableName="answers">
            <column name="response_id" value="1"/>
            <column name="question_id" value="3"/>
            <column name="selected_option_id" value="5"/>
        </insert>
        <insert tableName="answers">
            <column name="response_id" value="1"/>
            <column name="question_id" value="3"/>
            <column name="selected_option_id" value="6"/>
        </insert>
        <insert tableName="answers">
            <column name="response_id" value="1"/>
            <column name="question_id" value="4"/>
            <column name="answer_text" value="Some description"/>
        </insert>
        <insert tableName="answers">
            <column name="response_id" value="1"/>
            <column name="question_id" value="5"/>
            <column name="answer_text" value="16"/>
        </insert>
        <insert tableName="answers">
            <column name="response_id" value="1"/>
            <column name="question_id" value="6"/>
            <column name="selected_option_id" value="8"/>
        </insert>
        <insert tableName="answers">
            <column name="response_id" value="1"/>
            <column name="question_id" value="7"/>
            <column name="selected_option_id" value="10"/>
        </insert>
        <insert tableName="answers">
            <column name="response_id" value="1"/>
            <column name="question_id" value="7"/>
            <column name="selected_option_id" value="12"/>
        </insert>
        <insert tableName="answers">
            <column name="response_id" value="1"/>
            <column name="question_id" value="8"/>
            <column name="answer_text" value="Some text"/>
        </insert>
    </changeSet>

    <changeSet id="insert-response-2" author="alexey">
        <insert tableName="responses">
            <column name="user_id" value="3"/>
            <column name="form_id" value="1"/>
        </insert>
    </changeSet>

    <changeSet id="insert-answers-resp2" author="alexey">
        <insert tableName="answers">
            <column name="response_id" value="2"/>
            <column name="question_id" value="1"/>
            <column name="answer_text" value="54"/>
        </insert>
        <insert tableName="answers">
            <column name="response_id" value="2"/>
            <column name="question_id" value="2"/>
            <column name="selected_option_id" value="1"/>
        </insert>
        <insert tableName="answers">
            <column name="response_id" value="2"/>
            <column name="question_id" value="3"/>
            <column name="selected_option_id" value="4"/>
        </insert>
        <insert tableName="answers">
            <column name="response_id" value="2"/>
            <column name="question_id" value="3"/>
            <column name="selected_option_id" value="5"/>
        </insert>
        <insert tableName="answers">
            <column name="response_id" value="2"/>
            <column name="question_id" value="3"/>
            <column name="selected_option_id" value="6"/>
        </insert>
        <insert tableName="answers">
            <column name="response_id" value="2"/>
            <column name="question_id" value="4"/>
            <column name="answer_text" value="Professional older rapper"/>
        </insert>
        <insert tableName="answers">
            <column name="response_id" value="2"/>
            <column name="question_id" value="5"/>
            <column name="answer_text" value="21"/>
        </insert>
        <insert tableName="answers">
            <column name="response_id" value="2"/>
            <column name="question_id" value="6"/>
            <column name="selected_option_id" value="8"/>
        </insert>
        <insert tableName="answers">
            <column name="response_id" value="2"/>
            <column name="question_id" value="7"/>
            <column name="selected_option_id" value="10"/>
        </insert>
        <insert tableName="answers">
            <column name="response_id" value="2"/>
            <column name="question_id" value="7"/>
            <column name="selected_option_id" value="11"/>
        </insert>
        <insert tableName="answers">
            <column name="response_id" value="2"/>
            <column name="question_id" value="8"/>
            <column name="answer_text" value="Nice"/>
        </insert>
    </changeSet>

    <changeSet id="insert-response-3" author="alexey">
        <insert tableName="responses">
            <column name="user_id" value="4"/>
            <column name="form_id" value="1"/>
        </insert>
    </changeSet>

    <changeSet id="insert-answers-user3" author="alexey">
        <insert tableName="answers">
            <column name="response_id" value="3"/>
            <column name="question_id" value="1"/>
            <column name="answer_text" value="25"/>
        </insert>
        <insert tableName="answers">
            <column name="response_id" value="3"/>
            <column name="question_id" value="2"/>
            <column name="selected_option_id" value="2"/>
        </insert>
        <insert tableName="answers">
            <column name="response_id" value="3"/>
            <column name="question_id" value="3"/>
            <column name="selected_option_id" value="4"/>
        </insert>
        <insert tableName="answers">
            <column name="response_id" value="3"/>
            <column name="question_id" value="4"/>
            <column name="answer_text" value="About user3"/>
        </insert>
        <insert tableName="answers">
            <column name="response_id" value="3"/>
            <column name="question_id" value="5"/>
            <column name="answer_text" value="40"/>
        </insert>
        <insert tableName="answers">
            <column name="response_id" value="3"/>
            <column name="question_id" value="6"/>
            <column name="selected_option_id" value="8"/>
        </insert>
        <insert tableName="answers">
            <column name="response_id" value="3"/>
            <column name="question_id" value="7"/>
            <column name="selected_option_id" value="10"/>
        </insert>
        <insert tableName="answers">
            <column name="response_id" value="3"/>
            <column name="question_id" value="8"/>
            <column name="answer_text" value="Review 3"/>
        </insert>
    </changeSet>

</databaseChangeLog>